<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Flow Shop Scheduling Gantt Chart</title>
    <link rel="stylesheet" href="dhtmlxgantt.css" type="text/css">
    <script src="dhtmlxgantt.js"></script>
    <style>
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
        }

        #gantt_here {
            width: 100%;
            height: 100vh;
        }
    </style>
</head>
<body>


<div id="gantt_here" style="width: 100%;"></div>


<script>


    gantt.config.duration_unit = "minute"; // Set duration unit to seconds

    gantt.config.date_format = "%Y-%m-%d %H:%i:%s"; // 确保刻度和时间线上显示时分秒

    gantt.config.task_date_format = "%Y-%m-%d %H:%i:%s"; // 确保任务列表中显示时分秒

    gantt.config.date_scale = "%H:%i";
    gantt.config.scale_unit = "minute";

    gantt.config.scale_height = 40; // Set scale height for each machine

    gantt.config.row_height = 40; // Set row height for each task

    gantt.config.min_column_width = 35; // Minimum width for the columns

    //gantt.config.readonly = true;
    var meachine_ganttData = [[[6, 48.0, 119.0, 1], [13, 119.0, 193.0, 1], [17, 193.0, 217.0, 1], [14, 217.0, 282.0, 1], [19, 282.0, 335.0, 1], [11, 335.0, 395.0, 1], [3, 395.0, 450.0, 1]], [[12, 50.0, 121.0, 1], [9, 121.0, 186.0, 1], [2, 186.0, 222.0, 1], [15, 222.0, 313.0, 1], [18, 313.0, 407.0, 1], [5, 407.0, 500.0, 1]], [[1, 53.0, 80.0, 1], [4, 80.0, 125.0, 1], [20, 125.0, 162.0, 1], [16, 162.0, 244.0, 1], [7, 244.0, 285.0, 1], [8, 285.0, 360.0, 1], [10, 360.0, 428.0, 1]], [[1, 107.0, 120.0, 2], [12, 127.0, 134.0, 2], [4, 134.0, 220.0, 2], [13, 220.0, 304.0, 2], [2, 304.0, 337.0, 2], [16, 337.0, 405.0, 2], [7, 405.0, 460.0, 2], [19, 460.0, 500.0, 2], [8, 500.0, 569.0, 2], [10, 569.0, 601.0, 2], [5, 601.0, 655.0, 2]], [[6, 128.0, 187.0, 2], [20, 187.0, 211.0, 2], [9, 211.0, 286.0, 2], [17, 286.0, 373.0, 2], [14, 373.0, 441.0, 2], [15, 441.0, 518.0, 2], [11, 518.0, 550.0, 2], [18, 550.0, 591.0, 2], [3, 591.0, 652.0, 2]], [[1, 132.0, 215.0, 3], [4, 225.0, 277.0, 3], [2, 342.0, 437.0, 3], [14, 444.0, 540.0, 3], [8, 574.0, 653.0, 3]], [[12, 144.0, 146.0, 3], [20, 219.0, 242.0, 3], [9, 294.0, 305.0, 3], [17, 381.0, 454.0, 3], [7, 470.0, 526.0, 3], [11, 558.0, 580.0, 3], [18, 599.0, 606.0, 3], [10, 611.0, 634.0, 3], [5, 665.0, 695.0, 3]], [[6, 201.0, 244.0, 3], [13, 320.0, 352.0, 3], [16, 421.0, 466.0, 3], [19, 516.0, 522.0, 3], [15, 532.0, 607.0, 3], [3, 666.0, 693.0, 3]], [[12, 230.0, 257.0, 4], [20, 288.0, 321.0, 4], [6, 321.0, 409.0, 4], [13, 409.0, 472.0, 4], [17, 472.0, 521.0, 4], [19, 527.0, 551.0, 4], [7, 551.0, 625.0, 4], [11, 625.0, 653.0, 4], [15, 653.0, 719.0, 4], [8, 719.0, 760.0, 4]], [[1, 264.0, 357.0, 4], [4, 357.0, 401.0, 4], [9, 401.0, 466.0, 4], [2, 466.0, 484.0, 4], [16, 484.0, 558.0, 4], [14, 561.0, 631.0, 4], [18, 631.0, 663.0, 4], [10, 663.0, 748.0, 4], [3, 748.0, 755.0, 4], [5, 755.0, 759.0, 4]]];
    var agv_ganttData =[[[0, 0.0, 42.0, 11, 0], [6, 42.0, 48.0, 0, 1], [0, 48.0, 54.0, 1, 0], [13, 54.0, 60.0, 0, 1], [0, 60.0, 66.0, 1, 0], [2, 66.0, 74.0, 0, 2], [0, 74.0, 82.0, 2, 0], [14, 82.0, 88.0, 0, 1], [0, 88.0, 94.0, 1, 0], [8, 94.0, 105.0, 0, 3], [0, 105.0, 105.0, 3, 3], [1, 105.0, 107.0, 3, 4], [0, 112.0, 119.0, 4, 1], [6, 119.0, 128.0, 1, 5], [0, 158.0, 162.0, 5, 3], [20, 162.0, 166.0, 3, 5], [0, 179.0, 186.0, 5, 2], [9, 186.0, 193.0, 2, 5], [0, 208.0, 217.0, 5, 1], [17, 217.0, 226.0, 1, 5], [0, 240.0, 244.0, 5, 3], [16, 244.0, 246.0, 3, 4], [0, 275.0, 282.0, 4, 1], [14, 282.0, 291.0, 1, 5], [0, 306.0, 313.0, 5, 2], [15, 313.0, 320.0, 2, 5], [0, 326.0, 335.0, 5, 1], [19, 335.0, 342.0, 1, 4], [0, 358.0, 360.0, 4, 3], [8, 360.0, 362.0, 3, 4], [0, 388.0, 395.0, 4, 1], [11, 395.0, 404.0, 1, 5], [0, 424.0, 428.0, 5, 3], [10, 428.0, 430.0, 3, 4], [0, 443.0, 450.0, 4, 1], [3, 450.0, 459.0, 1, 5], [0, 493.0, 500.0, 5, 2], [5, 500.0, 505.0, 2, 4], [0, 516.0, 518.0, 4, 5], [15, 518.0, 532.0, 5, 8], [0, 536.0, 550.0, 8, 5], [11, 550.0, 558.0, 5, 7], [0, 559.0, 569.0, 7, 4], [8, 569.0, 574.0, 4, 6], [0, 588.0, 591.0, 6, 5], [18, 591.0, 599.0, 5, 7], [0, 644.0, 652.0, 7, 5], [3, 652.0, 666.0, 5, 8], [0, 693.0, 693.0, 8, 8], [3, 693.0, 700.0, 8, 10]], [[0, 0.0, 42.0, 11, 0], [12, 42.0, 50.0, 0, 2], [0, 50.0, 58.0, 2, 0], [9, 58.0, 66.0, 0, 2], [0, 66.0, 74.0, 2, 0], [17, 74.0, 80.0, 0, 1], [0, 80.0, 86.0, 1, 0], [15, 86.0, 94.0, 0, 2], [0, 94.0, 102.0, 2, 0], [11, 102.0, 108.0, 0, 1], [0, 108.0, 114.0, 1, 0], [3, 114.0, 120.0, 0, 1], [0, 120.0, 122.0, 1, 2], [12, 122.0, 127.0, 2, 4], [0, 186.0, 193.0, 4, 1], [13, 193.0, 200.0, 1, 4], [0, 217.0, 222.0, 4, 2], [2, 222.0, 227.0, 2, 4], [0, 283.0, 285.0, 4, 3], [7, 285.0, 287.0, 3, 4], [0, 402.0, 407.0, 4, 2], [18, 407.0, 414.0, 2, 5], [0, 441.0, 441.0, 5, 5], [14, 441.0, 444.0, 5, 6], [0, 455.0, 460.0, 6, 4], [7, 460.0, 470.0, 4, 7], [0, 490.0, 500.0, 7, 4], [19, 500.0, 516.0, 4, 8], [0, 585.0, 601.0, 8, 4], [10, 601.0, 611.0, 4, 7], [0, 645.0, 655.0, 7, 4], [5, 655.0, 665.0, 4, 7], [0, 695.0, 695.0, 7, 7], [5, 695.0, 708.0, 7, 10]], [[0, 0.0, 42.0, 11, 0], [1, 42.0, 53.0, 0, 3], [0, 53.0, 64.0, 3, 0], [20, 64.0, 75.0, 0, 3], [0, 75.0, 86.0, 3, 0], [7, 86.0, 97.0, 0, 3], [0, 97.0, 108.0, 3, 0], [10, 108.0, 119.0, 0, 3], [0, 125.0, 125.0, 3, 3], [4, 125.0, 127.0, 3, 4], [0, 127.0, 127.0, 4, 4], [1, 127.0, 132.0, 4, 6], [0, 184.0, 187.0, 6, 5], [6, 187.0, 201.0, 5, 8], [0, 204.0, 220.0, 8, 4], [4, 220.0, 225.0, 4, 6], [0, 283.0, 286.0, 6, 5], [9, 286.0, 294.0, 5, 7], [0, 294.0, 304.0, 7, 4], [13, 304.0, 320.0, 4, 8], [0, 321.0, 337.0, 8, 4], [2, 337.0, 342.0, 4, 6], [0, 370.0, 373.0, 6, 5], [17, 373.0, 381.0, 5, 7], [0, 395.0, 405.0, 7, 4], [16, 405.0, 421.0, 4, 8], [0, 426.0, 437.0, 8, 6], [2, 437.0, 455.0, 6, 10], [0, 459.0, 466.0, 10, 8], [16, 466.0, 473.0, 8, 10], [0, 515.0, 522.0, 10, 8], [19, 522.0, 527.0, 8, 9], [0, 527.0, 543.0, 9, 6], [14, 543.0, 561.0, 6, 10], [0, 567.0, 580.0, 10, 7], [11, 580.0, 591.0, 7, 9], [0, 595.0, 606.0, 9, 7], [18, 606.0, 619.0, 7, 10], [0, 621.0, 634.0, 10, 7], [10, 634.0, 647.0, 7, 10]], [[0, 0.0, 42.0, 11, 0], [4, 42.0, 53.0, 0, 3], [0, 53.0, 64.0, 3, 0], [16, 64.0, 75.0, 0, 3], [0, 75.0, 86.0, 3, 0], [19, 86.0, 92.0, 0, 1], [0, 92.0, 98.0, 1, 0], [18, 98.0, 106.0, 0, 2], [0, 106.0, 114.0, 2, 0], [5, 114.0, 122.0, 0, 2], [0, 129.0, 134.0, 2, 4], [12, 134.0, 144.0, 4, 7], [0, 203.0, 211.0, 7, 5], [20, 211.0, 219.0, 5, 7], [0, 219.0, 219.0, 7, 7], [12, 219.0, 230.0, 7, 9], [0, 230.0, 246.0, 9, 6], [1, 246.0, 264.0, 6, 10], [0, 264.0, 277.0, 10, 7], [20, 277.0, 288.0, 7, 9], [0, 288.0, 293.0, 9, 8], [6, 293.0, 298.0, 8, 9], [0, 298.0, 314.0, 9, 6], [4, 314.0, 332.0, 6, 10], [0, 332.0, 345.0, 10, 7], [9, 345.0, 358.0, 7, 10], [0, 358.0, 365.0, 10, 8], [13, 365.0, 370.0, 8, 9], [0, 443.0, 454.0, 9, 7], [17, 454.0, 465.0, 7, 9], [0, 515.0, 526.0, 9, 7], [7, 526.0, 537.0, 7, 9], [0, 602.0, 607.0, 9, 8], [15, 607.0, 612.0, 8, 9], [0, 637.0, 653.0, 9, 6], [8, 653.0, 669.0, 6, 9]]];



    var colors = ["#15b01a", "#0343df", "#e50000", "#f97306", "#653700", "#929591", "#00ffff", "#6e750e",

        "#a03623", "#fac205", "#bf9005", "#029386", "#214761", "#ffd1df", "#e6daa6"];


    gantt.init("gantt_here");

    gantt.parse({

        data: (function () {

            var tasks = [];

            var taskIndex = 1;

            for (var m = 0; m < meachine_ganttData.length; m++) { // Iterate over machines
                var end_job = meachine_ganttData[m][meachine_ganttData[m].length - 1];
                var star_job = meachine_ganttData[m][0];
                var dur_time = end_job[2] - star_job[1]
                var m_index = m + 1

                var startDate = new Date(); // 获取当前日期和时间
                //var startDate = new Date();

                var startDays = star_job[1]; // 假设 job[1] 是要添加的天数
                function addDays(startDate, days) {

                    var result = new Date(startDate);

                    result.setDate(result.getDate() + days);
                    console.log(result)

                    return result;

                }
                function addMinutes(startDate, minutes) {

                    var result = new Date(startDate);



                    result.setMinutes(result.getMinutes() + minutes);

                    console.log(result);



                    return result;

                }

                var newStartDate = addMinutes(startDate, startDays);
                tasks.push({

                    id: taskIndex,

                    text: "M" + m_index,

                    start_date: newStartDate,//job[1],

                    duration: dur_time, // Convert days to seconds

                    parent: 0,

                    progress: 0.0,

                    open: true,
                    render: 'split',

                    color: '#666'// Job color

                });
                taskIndex++

            }

            for (var m = 0; m < agv_ganttData.length; m++) { // Iterate over machines
                var end_job = agv_ganttData[m][agv_ganttData[m].length - 1];
                var star_job = agv_ganttData[m][0];
                var dur_time = end_job[2] - star_job[1]
                var m_index = m + 1

                var startDate = new Date(); // 获取当前日期和时间
                //var startDate = new Date();

                var startDays = star_job[1]; // 假设 job[1] 是要添加的天数
                function addDays(startDate, days) {

                    var result = new Date(startDate);

                    result.setDate(result.getDate() + days);
                    console.log(result)

                    return result;

                }
                function addMinutes(startDate, minutes) {

                    var result = new Date(startDate);



                    result.setMinutes(result.getMinutes() + minutes);

                    console.log(result);



                    return result;

                }

                var newStartDate = addMinutes(startDate, startDays);
                tasks.push({

                    id: taskIndex,

                    text: "AGV" + m_index,

                    start_date: newStartDate,//job[1],

                    duration: dur_time, // Convert days to seconds

                    parent: 0,

                    progress: 0.0,

                    open: true,
                    render: 'split',

                    color: '#666'// Job color

                });
                taskIndex++

            }






            for (var m = 0; m < meachine_ganttData.length; m++) { // Iterate over machines

                for (var j = 0; j < meachine_ganttData[m].length; j++) { // Iterate over jobs

                    var job = meachine_ganttData[m][j];

                    // 假设 startDate 是一个 Date 对象，days 是要添加的天数

                    function addDays(startDate, days) {

                        var result = new Date(startDate);

                        result.setDate(result.getDate() + days);
                        console.log(result)

                        return result;

                    }
                    function addMinutes(startDate, minutes) {

                        var result = new Date(startDate);



                        result.setMinutes(result.getMinutes() + minutes);

                        console.log(result);



                        return result;

                    }


// 使用示例

                    var startDate = new Date();

                    var jobDays = job[1]; // 假设 job[1] 是要添加的天数

                    var newStartDate = addMinutes(startDate, jobDays);


// 然后将 newStartDate 用作任务的开始日期
                    var op = "|T" + job[3] + '|'

                    tasks.push({

                        id: taskIndex++,

                        text: "J" + job[0] + op,

                        start_date: newStartDate,

                        duration: job[2] - job[1],

                        parent: m + 1,

                        progress: 0.0,

                        open: true,

                        color: colors[(job[0] - 1) % colors.length]

                    });

                }

            }



            for (var m = 0; m < agv_ganttData.length; m++) { // Iterate over machines

                for (var j = 0; j < agv_ganttData[m].length; j++) { // Iterate over jobs

                    var job = agv_ganttData[m][j];

                    // 假设 startDate 是一个 Date 对象，days 是要添加的天数

                    function addDays(startDate, days) {

                        var result = new Date(startDate);

                        result.setDate(result.getDate() + days);
                        console.log(result)

                        return result;

                    }
                    function addMinutes(startDate, minutes) {

                        var result = new Date(startDate);



                        result.setMinutes(result.getMinutes() + minutes);

                        console.log(result);



                        return result;

                    }


// 使用示例

                    var startDate = new Date();

                    var jobDays = job[1]; // 假设 job[1] 是要添加的天数

                    var newStartDate = addMinutes(startDate, jobDays);


// 然后将 newStartDate 用作任务的开始日期
                    var from_to = "|F" + job[3] + '|T'+job[4]+'|'
                    tasks.push({

                        id: taskIndex++,

                        text: "J" + job[0] + from_to,

                        start_date: newStartDate,

                        duration: job[2] - job[1],

                        parent: meachine_ganttData.length+m + 1,

                        progress: 0.0,

                        open: true,

                        color: colors[(job[0] - 1) % colors.length]

                    });

                }

            }



            return tasks;

        })(),

        links: []

    });


    // Set date format
    //gantt.config.start_date = this.nowDate.format('YYYY-MM-DD')
    //gantt.config.end_date = this.newDate.format('YYYY-MM-DD')

    //    gantt.config.date_format = "%Y-%m-%d %H:%i:%s"; // Include seconds in date format
    //gantt.resize();


    // Adjust the view

    gantt.attachEvent("onGanttReady", function () {

        gantt.showDate(gantt.date.add(gantt.date.min, gantt.date.day, 1));

        gantt.showDate(gantt.date.add(gantt.date.max, gantt.date.day, 10));

    });

</script>

</body>
</html>
