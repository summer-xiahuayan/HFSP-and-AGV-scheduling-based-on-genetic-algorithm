<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Flow Shop Scheduling Gantt Chart</title>
    <link rel="stylesheet" href="dhtmlxgantt.css" type="text/css">
    <script src="dhtmlxgantt.js"></script>
    <style>
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
        }

        #gantt_here {
            width: 100%;
            height: 100vh;
        }
    </style>
</head>
<body>


<div id="gantt_here" style="width: 100%;"></div>


<script>


    gantt.config.duration_unit = "minute"; // Set duration unit to seconds

    gantt.config.date_format = "%Y-%m-%d %H:%i:%s"; // 确保刻度和时间线上显示时分秒

    gantt.config.task_date_format = "%Y-%m-%d %H:%i:%s"; // 确保任务列表中显示时分秒

    gantt.config.date_scale = "%H:%i";
    gantt.config.scale_unit = "minute";

    gantt.config.scale_height = 40; // Set scale height for each machine

    gantt.config.row_height = 40; // Set row height for each task

    gantt.config.min_column_width = 35; // Minimum width for the columns

    //gantt.config.readonly = true;
    var meachine_ganttData = [[[10, 48.0, 116.0, 1], [12, 116.0, 187.0, 1], [6, 187.0, 258.0, 1], [14, 258.0, 323.0, 1], [11, 323.0, 383.0, 1], [5, 383.0, 476.0, 1]], [[1, 50.0, 77.0, 1], [20, 77.0, 114.0, 1], [7, 114.0, 155.0, 1], [8, 155.0, 230.0, 1], [16, 230.0, 312.0, 1], [17, 312.0, 336.0, 1], [2, 336.0, 372.0, 1], [19, 372.0, 425.0, 1]], [[3, 53.0, 108.0, 1], [13, 108.0, 182.0, 1], [9, 182.0, 247.0, 1], [15, 247.0, 338.0, 1], [4, 338.0, 383.0, 1], [18, 383.0, 477.0, 1]], [[1, 117.0, 130.0, 2], [20, 130.0, 154.0, 2], [10, 154.0, 186.0, 2], [13, 186.0, 270.0, 2], [9, 270.0, 345.0, 2], [16, 345.0, 413.0, 2], [17, 413.0, 500.0, 2], [2, 500.0, 533.0, 2], [11, 533.0, 565.0, 2], [19, 565.0, 605.0, 2], [18, 605.0, 646.0, 2]], [[3, 117.0, 178.0, 2], [7, 178.0, 233.0, 2], [12, 233.0, 240.0, 2], [8, 240.0, 309.0, 2], [6, 309.0, 368.0, 2], [14, 368.0, 436.0, 2], [15, 436.0, 513.0, 2], [4, 513.0, 599.0, 2], [5, 599.0, 653.0, 2]], [[1, 135.0, 218.0, 3], [7, 236.0, 292.0, 3], [9, 350.0, 361.0, 3], [16, 418.0, 463.0, 3], [15, 516.0, 591.0, 3], [4, 602.0, 654.0, 3]], [[20, 164.0, 187.0, 3], [10, 196.0, 219.0, 3], [13, 280.0, 312.0, 3], [6, 376.0, 419.0, 3], [17, 510.0, 583.0, 3], [11, 583.0, 605.0, 3], [19, 615.0, 621.0, 3], [18, 656.0, 663.0, 3]], [[3, 192.0, 219.0, 3], [12, 254.0, 256.0, 3], [8, 323.0, 402.0, 3], [14, 450.0, 546.0, 3], [2, 549.0, 644.0, 3], [5, 667.0, 697.0, 3]], [[20, 207.0, 240.0, 4], [3, 253.0, 260.0, 4], [10, 275.0, 360.0, 4], [7, 360.0, 434.0, 4], [8, 434.0, 475.0, 4], [6, 475.0, 563.0, 4], [17, 594.0, 643.0, 4], [11, 643.0, 671.0, 4], [19, 671.0, 695.0, 4], [2, 695.0, 713.0, 4], [18, 713.0, 745.0, 4]], [[1, 241.0, 334.0, 4], [12, 334.0, 361.0, 4], [13, 361.0, 424.0, 4], [9, 424.0, 489.0, 4], [16, 489.0, 563.0, 4], [14, 563.0, 633.0, 4], [15, 633.0, 699.0, 4], [4, 699.0, 743.0, 4], [5, 743.0, 747.0, 4]]];
    var agv_ganttData =[[[0, 0.0, 42.0, 11, 0], [10, 42.0, 48.0, 0, 1], [0, 48.0, 54.0, 1, 0], [13, 54.0, 65.0, 0, 3], [0, 65.0, 76.0, 3, 0], [16, 76.0, 84.0, 0, 2], [0, 84.0, 92.0, 2, 0], [17, 92.0, 100.0, 0, 2], [0, 100.0, 108.0, 2, 0], [18, 108.0, 119.0, 0, 3], [0, 119.0, 122.0, 3, 2], [20, 122.0, 127.0, 2, 4], [0, 150.0, 155.0, 4, 2], [7, 155.0, 162.0, 2, 5], [0, 178.0, 182.0, 5, 3], [13, 182.0, 184.0, 3, 4], [0, 225.0, 230.0, 4, 2], [8, 230.0, 237.0, 2, 5], [0, 243.0, 247.0, 5, 3], [9, 247.0, 249.0, 3, 4], [0, 251.0, 258.0, 4, 1], [6, 258.0, 267.0, 1, 5], [0, 305.0, 312.0, 5, 2], [16, 312.0, 317.0, 2, 4], [0, 331.0, 336.0, 4, 2], [17, 336.0, 341.0, 2, 4], [0, 367.0, 372.0, 4, 2], [2, 372.0, 377.0, 2, 4], [0, 381.0, 383.0, 4, 3], [4, 383.0, 387.0, 3, 5], [0, 418.0, 425.0, 5, 2], [19, 425.0, 430.0, 2, 4], [0, 469.0, 476.0, 4, 1], [5, 476.0, 485.0, 1, 5], [0, 498.0, 500.0, 5, 4], [17, 500.0, 510.0, 4, 7], [0, 523.0, 533.0, 7, 4], [2, 533.0, 549.0, 4, 8], [0, 549.0, 565.0, 8, 4], [11, 565.0, 575.0, 4, 7], [0, 591.0, 599.0, 7, 5], [4, 599.0, 602.0, 5, 6], [0, 641.0, 646.0, 6, 4], [18, 646.0, 656.0, 4, 7], [0, 663.0, 663.0, 7, 7], [18, 663.0, 674.0, 7, 9], [0, 692.0, 697.0, 9, 8], [5, 697.0, 704.0, 8, 10]], [[0, 0.0, 42.0, 11, 0], [1, 42.0, 50.0, 0, 2], [0, 50.0, 58.0, 2, 0], [7, 58.0, 66.0, 0, 2], [0, 66.0, 74.0, 2, 0], [6, 74.0, 80.0, 0, 1], [0, 80.0, 86.0, 1, 0], [14, 86.0, 92.0, 0, 1], [0, 92.0, 98.0, 1, 0], [2, 98.0, 106.0, 0, 2], [0, 106.0, 114.0, 2, 0], [5, 114.0, 120.0, 0, 1], [0, 120.0, 120.0, 1, 1], [10, 120.0, 127.0, 1, 4], [0, 180.0, 187.0, 4, 1], [12, 187.0, 196.0, 1, 5], [0, 314.0, 323.0, 5, 1], [14, 323.0, 332.0, 1, 5], [0, 334.0, 338.0, 5, 3], [15, 338.0, 342.0, 3, 5], [0, 374.0, 383.0, 5, 1], [11, 383.0, 390.0, 1, 4], [0, 475.0, 477.0, 4, 3], [18, 477.0, 479.0, 3, 4], [0, 511.0, 513.0, 4, 5], [15, 513.0, 516.0, 5, 6], [0, 600.0, 605.0, 6, 4], [19, 605.0, 615.0, 4, 7], [0, 645.0, 653.0, 7, 5], [5, 653.0, 667.0, 5, 8]], [[0, 0.0, 42.0, 11, 0], [3, 42.0, 53.0, 0, 3], [0, 53.0, 64.0, 3, 0], [8, 64.0, 72.0, 0, 2], [0, 72.0, 80.0, 2, 0], [15, 80.0, 91.0, 0, 3], [0, 91.0, 102.0, 3, 0], [4, 102.0, 113.0, 0, 3], [0, 113.0, 113.0, 3, 3], [3, 113.0, 117.0, 3, 5], [0, 128.0, 130.0, 5, 4], [1, 130.0, 135.0, 4, 6], [0, 149.0, 154.0, 6, 4], [20, 154.0, 164.0, 4, 7], [0, 170.0, 178.0, 7, 5], [3, 178.0, 192.0, 5, 8], [0, 219.0, 233.0, 8, 5], [7, 233.0, 236.0, 5, 6], [0, 237.0, 240.0, 6, 5], [12, 240.0, 254.0, 5, 8], [0, 254.0, 270.0, 8, 4], [13, 270.0, 280.0, 4, 7], [0, 301.0, 309.0, 7, 5], [8, 309.0, 323.0, 5, 8], [0, 329.0, 345.0, 8, 4], [9, 345.0, 350.0, 4, 6], [0, 365.0, 368.0, 6, 5], [6, 368.0, 376.0, 5, 7], [0, 403.0, 413.0, 7, 4], [16, 413.0, 418.0, 4, 6], [0, 433.0, 436.0, 6, 5], [14, 436.0, 450.0, 5, 8], [0, 452.0, 463.0, 8, 6], [16, 463.0, 481.0, 6, 10], [0, 539.0, 546.0, 10, 8], [14, 546.0, 553.0, 8, 10], [0, 570.0, 583.0, 10, 7], [17, 583.0, 594.0, 7, 9], [0, 594.0, 605.0, 9, 7], [11, 605.0, 616.0, 7, 9], [0, 639.0, 644.0, 9, 8], [2, 644.0, 649.0, 8, 9]], [[0, 0.0, 42.0, 11, 0], [20, 42.0, 50.0, 0, 2], [0, 50.0, 58.0, 2, 0], [12, 58.0, 64.0, 0, 1], [0, 64.0, 70.0, 1, 0], [9, 70.0, 81.0, 0, 3], [0, 81.0, 92.0, 3, 0], [11, 92.0, 98.0, 0, 1], [0, 98.0, 104.0, 1, 0], [19, 104.0, 112.0, 0, 2], [0, 112.0, 112.0, 2, 2], [1, 112.0, 117.0, 2, 4], [0, 186.0, 186.0, 4, 4], [10, 186.0, 196.0, 4, 7], [0, 196.0, 196.0, 7, 7], [20, 196.0, 207.0, 7, 9], [0, 207.0, 223.0, 9, 6], [1, 223.0, 241.0, 6, 10], [0, 241.0, 248.0, 10, 8], [3, 248.0, 253.0, 8, 9], [0, 253.0, 264.0, 9, 7], [10, 264.0, 275.0, 7, 9], [0, 275.0, 280.0, 9, 8], [12, 280.0, 287.0, 8, 10], [0, 287.0, 305.0, 10, 6], [7, 305.0, 321.0, 6, 9], [0, 321.0, 332.0, 9, 7], [13, 332.0, 345.0, 7, 10], [0, 345.0, 363.0, 10, 6], [9, 363.0, 381.0, 6, 10], [0, 395.0, 402.0, 10, 8], [8, 402.0, 407.0, 8, 9], [0, 408.0, 419.0, 9, 7], [6, 419.0, 430.0, 7, 9], [0, 575.0, 591.0, 9, 6], [15, 591.0, 609.0, 6, 10], [0, 609.0, 622.0, 10, 7], [19, 622.0, 633.0, 7, 9], [0, 638.0, 654.0, 9, 6], [4, 654.0, 672.0, 6, 10]]];



    var colors = ["#15b01a", "#0343df", "#e50000", "#f97306", "#653700", "#929591", "#00ffff", "#6e750e",

        "#a03623", "#fac205", "#bf9005", "#029386", "#214761", "#ffd1df", "#e6daa6"];


    gantt.init("gantt_here");

    gantt.parse({

        data: (function () {

            var tasks = [];

            var taskIndex = 1;

            for (var m = 0; m < meachine_ganttData.length; m++) { // Iterate over machines
                var end_job = meachine_ganttData[m][meachine_ganttData[m].length - 1];
                var star_job = meachine_ganttData[m][0];
                var dur_time = end_job[2] - star_job[1]
                var m_index = m + 1

                var startDate = new Date(); // 获取当前日期和时间
                //var startDate = new Date();

                var startDays = star_job[1]; // 假设 job[1] 是要添加的天数
                function addDays(startDate, days) {

                    var result = new Date(startDate);

                    result.setDate(result.getDate() + days);
                    console.log(result)

                    return result;

                }
                function addMinutes(startDate, minutes) {

                    var result = new Date(startDate);



                    result.setMinutes(result.getMinutes() + minutes);

                    console.log(result);



                    return result;

                }

                var newStartDate = addMinutes(startDate, startDays);
                tasks.push({

                    id: taskIndex,

                    text: "M" + m_index,

                    start_date: newStartDate,//job[1],

                    duration: dur_time, // Convert days to seconds

                    parent: 0,

                    progress: 0.0,

                    open: true,
                    render: 'split',

                    color: '#666'// Job color

                });
                taskIndex++

            }

            for (var m = 0; m < agv_ganttData.length; m++) { // Iterate over machines
                var end_job = agv_ganttData[m][agv_ganttData[m].length - 1];
                var star_job = agv_ganttData[m][0];
                var dur_time = end_job[2] - star_job[1]
                var m_index = m + 1

                var startDate = new Date(); // 获取当前日期和时间
                //var startDate = new Date();

                var startDays = star_job[1]; // 假设 job[1] 是要添加的天数
                function addDays(startDate, days) {

                    var result = new Date(startDate);

                    result.setDate(result.getDate() + days);
                    console.log(result)

                    return result;

                }
                function addMinutes(startDate, minutes) {

                    var result = new Date(startDate);



                    result.setMinutes(result.getMinutes() + minutes);

                    console.log(result);



                    return result;

                }

                var newStartDate = addMinutes(startDate, startDays);
                tasks.push({

                    id: taskIndex,

                    text: "AGV" + m_index,

                    start_date: newStartDate,//job[1],

                    duration: dur_time, // Convert days to seconds

                    parent: 0,

                    progress: 0.0,

                    open: true,
                    render: 'split',

                    color: '#666'// Job color

                });
                taskIndex++

            }






            for (var m = 0; m < meachine_ganttData.length; m++) { // Iterate over machines

                for (var j = 0; j < meachine_ganttData[m].length; j++) { // Iterate over jobs

                    var job = meachine_ganttData[m][j];

                    // 假设 startDate 是一个 Date 对象，days 是要添加的天数

                    function addDays(startDate, days) {

                        var result = new Date(startDate);

                        result.setDate(result.getDate() + days);
                        console.log(result)

                        return result;

                    }
                    function addMinutes(startDate, minutes) {

                        var result = new Date(startDate);



                        result.setMinutes(result.getMinutes() + minutes);

                        console.log(result);



                        return result;

                    }


// 使用示例

                    var startDate = new Date();

                    var jobDays = job[1]; // 假设 job[1] 是要添加的天数

                    var newStartDate = addMinutes(startDate, jobDays);


// 然后将 newStartDate 用作任务的开始日期
                    var op = "|T" + job[3] + '|'

                    tasks.push({

                        id: taskIndex++,

                        text: "J" + job[0] + op,

                        start_date: newStartDate,

                        duration: job[2] - job[1],

                        parent: m + 1,

                        progress: 0.0,

                        open: true,

                        color: colors[(job[0] - 1) % colors.length]

                    });

                }

            }



            for (var m = 0; m < agv_ganttData.length; m++) { // Iterate over machines

                for (var j = 0; j < agv_ganttData[m].length; j++) { // Iterate over jobs

                    var job = agv_ganttData[m][j];

                    // 假设 startDate 是一个 Date 对象，days 是要添加的天数

                    function addDays(startDate, days) {

                        var result = new Date(startDate);

                        result.setDate(result.getDate() + days);
                        console.log(result)

                        return result;

                    }
                    function addMinutes(startDate, minutes) {

                        var result = new Date(startDate);



                        result.setMinutes(result.getMinutes() + minutes);

                        console.log(result);



                        return result;

                    }


// 使用示例

                    var startDate = new Date();

                    var jobDays = job[1]; // 假设 job[1] 是要添加的天数

                    var newStartDate = addMinutes(startDate, jobDays);


// 然后将 newStartDate 用作任务的开始日期
                    var from_to = "|F" + job[3] + '|T'+job[4]+'|'
                    tasks.push({

                        id: taskIndex++,

                        text: "J" + job[0] + from_to,

                        start_date: newStartDate,

                        duration: job[2] - job[1],

                        parent: meachine_ganttData.length+m + 1,

                        progress: 0.0,

                        open: true,

                        color: colors[(job[0] - 1) % colors.length]

                    });

                }

            }



            return tasks;

        })(),

        links: []

    });


    // Set date format
    //gantt.config.start_date = this.nowDate.format('YYYY-MM-DD')
    //gantt.config.end_date = this.newDate.format('YYYY-MM-DD')

    //    gantt.config.date_format = "%Y-%m-%d %H:%i:%s"; // Include seconds in date format
    //gantt.resize();


    // Adjust the view

    gantt.attachEvent("onGanttReady", function () {

        gantt.showDate(gantt.date.add(gantt.date.min, gantt.date.day, 1));

        gantt.showDate(gantt.date.add(gantt.date.max, gantt.date.day, 10));

    });

</script>

</body>
</html>
